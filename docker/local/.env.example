# Local Development Environment Configuration
# Copy this to local.env and customize as needed

# Environment
ENV=local

# Core Services (local instances)
REDIS_URL=redis://redis:6379/0
DB_URL=postgresql://postgres:password@postgres:5432/stopsign

# MinIO (local S3-compatible storage)
MINIO_ENDPOINT=minio:9000
MINIO_ACCESS_KEY=minioadmin
MINIO_SECRET_KEY=minioadmin
MINIO_BUCKET=stopsign-local

# Video Input
# Use sample video file (no real RTSP needed)
RTSP_URL=file:///app/sample_data/sample.mp4
# Alternative: Real RTSP from local camera
# RTSP_URL=rtsp://192.168.1.100/stream
# For macOS: RTSP_URL=rtsp://host.docker.internal:8554/stream

# Frame Processing
RAW_FRAME_KEY=raw_frames
PROCESSED_FRAME_KEY=processed_frames
FRAME_BUFFER_SIZE=200

# AI Model (CPU-optimized)
YOLO_MODEL_NAME=yolov8n.pt
YOLO_DEVICE=cpu

# Ports
PROMETHEUS_PORT=9100
WEB_SERVER_PORT=8000

# FFmpeg (CPU encoding)
FFMPEG_ENCODER=libx264
FFMPEG_PRESET=veryfast

# Optional: Grafana dashboard (if running separately)
# GRAFANA_URL=http://localhost:3000

# ==========================================================================
# MediaMTX (New Media Plane - optional, for low-latency streaming)
# ==========================================================================
# Video source: "legacy_hls" (default), "mediamtx_hls", or "mediamtx_webrtc"
VIDEO_SOURCE=legacy_hls
# MediaMTX URLs - must be browser-reachable (use localhost, not docker service name)
# For production, use a reverse proxy to avoid CORS issues
# MEDIAMTX_HLS_URL=http://localhost:8888/camera/index.m3u8
# MEDIAMTX_WEBRTC_URL=http://localhost:8889/camera/whep

# WebRTC additional hosts for ICE candidates (comma-separated)
# Add your LAN IP/hostname for access from other devices
# WEBRTC_HOSTS=localhost,host.docker.internal,192.168.1.100

# Analyzer frame source: "redis" (legacy via rtsp_to_redis), "rtsp" (direct from MediaMTX)
# When using RTSP, the analyzer reads directly from MediaMTX, bypassing Redis frame queue
FRAME_SOURCE=redis
# RTSP URL for direct MediaMTX connection (only used when FRAME_SOURCE=rtsp)
# ANALYZER_RTSP_URL=rtsp://mediamtx:8554/camera